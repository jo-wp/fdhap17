{"version":3,"names":["_fieldTypes","_interopRequireDefault","require","_dataformControls","_dataformCombinedEdit","normalizeFields","fields","map","field","_field$sort","_field$isValid","_field$enableHiding","_field$enableSorting","fieldTypeDefinition","getFieldTypeDefinition","type","getValue","item","id","sort","a","b","direction","isValid","context","Edit","getControl","renderFromElements","value","elements","find","element","label","render","header","enableHiding","enableSorting","normalizeCombinedFields","combinedFields","combinedField","DataFormCombinedEdit","children","fieldId","filter"],"sources":["@wordpress/dataviews/src/normalize-fields.ts"],"sourcesContent":["/**\n * Internal dependencies\n */\nimport getFieldTypeDefinition from './field-types';\nimport type {\n\tCombinedFormField,\n\tField,\n\tNormalizedField,\n\tNormalizedCombinedFormField,\n} from './types';\nimport { getControl } from './dataform-controls';\nimport DataFormCombinedEdit from './components/dataform-combined-edit';\n\n/**\n * Apply default values and normalize the fields config.\n *\n * @param fields Fields config.\n * @return Normalized fields config.\n */\nexport function normalizeFields< Item >(\n\tfields: Field< Item >[]\n): NormalizedField< Item >[] {\n\treturn fields.map( ( field ) => {\n\t\tconst fieldTypeDefinition = getFieldTypeDefinition( field.type );\n\n\t\tconst getValue =\n\t\t\tfield.getValue || ( ( { item } ) => ( item as any )[ field.id ] );\n\n\t\tconst sort =\n\t\t\tfield.sort ??\n\t\t\tfunction sort( a, b, direction ) {\n\t\t\t\treturn fieldTypeDefinition.sort(\n\t\t\t\t\tgetValue( { item: a } ),\n\t\t\t\t\tgetValue( { item: b } ),\n\t\t\t\t\tdirection\n\t\t\t\t);\n\t\t\t};\n\n\t\tconst isValid =\n\t\t\tfield.isValid ??\n\t\t\tfunction isValid( item, context ) {\n\t\t\t\treturn fieldTypeDefinition.isValid(\n\t\t\t\t\tgetValue( { item } ),\n\t\t\t\t\tcontext\n\t\t\t\t);\n\t\t\t};\n\n\t\tconst Edit = getControl( field, fieldTypeDefinition );\n\n\t\tconst renderFromElements = ( { item }: { item: Item } ) => {\n\t\t\tconst value = getValue( { item } );\n\t\t\treturn (\n\t\t\t\tfield?.elements?.find( ( element ) => element.value === value )\n\t\t\t\t\t?.label || getValue( { item } )\n\t\t\t);\n\t\t};\n\n\t\tconst render =\n\t\t\tfield.render || ( field.elements ? renderFromElements : getValue );\n\n\t\treturn {\n\t\t\t...field,\n\t\t\tlabel: field.label || field.id,\n\t\t\theader: field.header || field.label || field.id,\n\t\t\tgetValue,\n\t\t\trender,\n\t\t\tsort,\n\t\t\tisValid,\n\t\t\tEdit,\n\t\t\tenableHiding: field.enableHiding ?? true,\n\t\t\tenableSorting: field.enableSorting ?? true,\n\t\t};\n\t} );\n}\n\n/**\n * Apply default values and normalize the fields config.\n *\n * @param combinedFields combined field list.\n * @param fields         Fields config.\n * @return Normalized fields config.\n */\nexport function normalizeCombinedFields< Item >(\n\tcombinedFields: CombinedFormField< Item >[],\n\tfields: Field< Item >[]\n): NormalizedCombinedFormField< Item >[] {\n\treturn combinedFields.map( ( combinedField ) => {\n\t\treturn {\n\t\t\t...combinedField,\n\t\t\tEdit: DataFormCombinedEdit,\n\t\t\tfields: normalizeFields(\n\t\t\t\tcombinedField.children\n\t\t\t\t\t.map( ( fieldId ) =>\n\t\t\t\t\t\tfields.find( ( { id } ) => id === fieldId )\n\t\t\t\t\t)\n\t\t\t\t\t.filter( ( field ): field is Field< Item > => !! field )\n\t\t\t),\n\t\t};\n\t} );\n}\n"],"mappings":"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","ignoreList":[]}