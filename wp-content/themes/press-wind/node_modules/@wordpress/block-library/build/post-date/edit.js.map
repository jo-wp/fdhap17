{"version":3,"names":["_clsx","_interopRequireDefault","require","_coreData","_element","_date","_blockEditor","_components","_i18n","_icons","_keycodes","_data","_jsxRuntime","PostDateEdit","attributes","textAlign","format","isLink","displayType","context","postId","postType","postTypeSlug","queryId","setAttributes","blockProps","useBlockProps","className","clsx","popoverAnchor","setPopoverAnchor","useState","popoverProps","useMemo","anchor","isDescendentOfQueryLoop","Number","isFinite","dateSettings","getDateSettings","siteFormat","formats","date","useEntityProp","siteTimeFormat","time","setDate","useSelect","select","coreStore","getPostType","dateLabel","__","postDate","jsx","dateTime","dateI18n","ref","children","humanTimeDiff","href","onClick","event","preventDefault","jsxs","Fragment","BlockControls","group","AlignmentControl","value","onChange","nextAlign","ToolbarGroup","Dropdown","renderContent","onClose","__experimentalPublishDateTimePicker","currentDate","is12Hour","is12HourFormat","dateOrder","_x","renderToggle","isOpen","onToggle","openOnArrowDown","keyCode","DOWN","ToolbarButton","icon","edit","title","onKeyDown","InspectorControls","PanelBody","__experimentalDateFormatPicker","defaultFormat","nextFormat","ToggleControl","__nextHasNoMarginBottom","label","labels","singular_name","sprintf","toLowerCase","checked","help","test"],"sources":["@wordpress/block-library/src/post-date/edit.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport clsx from 'clsx';\n\n/**\n * WordPress dependencies\n */\nimport { useEntityProp, store as coreStore } from '@wordpress/core-data';\nimport { useMemo, useState } from '@wordpress/element';\nimport {\n\tdateI18n,\n\thumanTimeDiff,\n\tgetSettings as getDateSettings,\n} from '@wordpress/date';\nimport {\n\tAlignmentControl,\n\tBlockControls,\n\tInspectorControls,\n\tuseBlockProps,\n\t__experimentalDateFormatPicker as DateFormatPicker,\n\t__experimentalPublishDateTimePicker as PublishDateTimePicker,\n} from '@wordpress/block-editor';\nimport {\n\tDropdown,\n\tToolbarGroup,\n\tToolbarButton,\n\tToggleControl,\n\tPanelBody,\n} from '@wordpress/components';\nimport { __, _x, sprintf } from '@wordpress/i18n';\nimport { edit } from '@wordpress/icons';\nimport { DOWN } from '@wordpress/keycodes';\nimport { useSelect } from '@wordpress/data';\n\nexport default function PostDateEdit( {\n\tattributes: { textAlign, format, isLink, displayType },\n\tcontext: { postId, postType: postTypeSlug, queryId },\n\tsetAttributes,\n} ) {\n\tconst blockProps = useBlockProps( {\n\t\tclassName: clsx( {\n\t\t\t[ `has-text-align-${ textAlign }` ]: textAlign,\n\t\t\t[ `wp-block-post-date__modified-date` ]: displayType === 'modified',\n\t\t} ),\n\t} );\n\n\t// Use internal state instead of a ref to make sure that the component\n\t// re-renders when the popover's anchor updates.\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\t// Memoize popoverProps to avoid returning a new object every time.\n\tconst popoverProps = useMemo(\n\t\t() => ( { anchor: popoverAnchor } ),\n\t\t[ popoverAnchor ]\n\t);\n\n\tconst isDescendentOfQueryLoop = Number.isFinite( queryId );\n\tconst dateSettings = getDateSettings();\n\tconst [ siteFormat = dateSettings.formats.date ] = useEntityProp(\n\t\t'root',\n\t\t'site',\n\t\t'date_format'\n\t);\n\tconst [ siteTimeFormat = dateSettings.formats.time ] = useEntityProp(\n\t\t'root',\n\t\t'site',\n\t\t'time_format'\n\t);\n\tconst [ date, setDate ] = useEntityProp(\n\t\t'postType',\n\t\tpostTypeSlug,\n\t\tdisplayType,\n\t\tpostId\n\t);\n\n\tconst postType = useSelect(\n\t\t( select ) =>\n\t\t\tpostTypeSlug\n\t\t\t\t? select( coreStore ).getPostType( postTypeSlug )\n\t\t\t\t: null,\n\t\t[ postTypeSlug ]\n\t);\n\n\tconst dateLabel =\n\t\tdisplayType === 'date' ? __( 'Post Date' ) : __( 'Post Modified Date' );\n\n\tlet postDate = date ? (\n\t\t<time dateTime={ dateI18n( 'c', date ) } ref={ setPopoverAnchor }>\n\t\t\t{ format === 'human-diff'\n\t\t\t\t? humanTimeDiff( date )\n\t\t\t\t: dateI18n( format || siteFormat, date ) }\n\t\t</time>\n\t) : (\n\t\tdateLabel\n\t);\n\n\tif ( isLink && date ) {\n\t\tpostDate = (\n\t\t\t<a\n\t\t\t\thref=\"#post-date-pseudo-link\"\n\t\t\t\tonClick={ ( event ) => event.preventDefault() }\n\t\t\t>\n\t\t\t\t{ postDate }\n\t\t\t</a>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls group=\"block\">\n\t\t\t\t<AlignmentControl\n\t\t\t\t\tvalue={ textAlign }\n\t\t\t\t\tonChange={ ( nextAlign ) => {\n\t\t\t\t\t\tsetAttributes( { textAlign: nextAlign } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ date &&\n\t\t\t\t\tdisplayType === 'date' &&\n\t\t\t\t\t! isDescendentOfQueryLoop && (\n\t\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t\t<Dropdown\n\t\t\t\t\t\t\t\tpopoverProps={ popoverProps }\n\t\t\t\t\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t\t\t\t\t<PublishDateTimePicker\n\t\t\t\t\t\t\t\t\t\tcurrentDate={ date }\n\t\t\t\t\t\t\t\t\t\tonChange={ setDate }\n\t\t\t\t\t\t\t\t\t\tis12Hour={ is12HourFormat(\n\t\t\t\t\t\t\t\t\t\t\tsiteTimeFormat\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t\t\t\t\tdateOrder={\n\t\t\t\t\t\t\t\t\t\t\t/* translators: Order of day, month, and year. Available formats are 'dmy', 'mdy', and 'ymd'. */\n\t\t\t\t\t\t\t\t\t\t\t_x( 'dmy', 'date order' )\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => {\n\t\t\t\t\t\t\t\t\tconst openOnArrowDown = ( event ) => {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t! isOpen &&\n\t\t\t\t\t\t\t\t\t\t\tevent.keyCode === DOWN\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\tonToggle();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\t\t\t\t\t\t\ticon={ edit }\n\t\t\t\t\t\t\t\t\t\t\ttitle={ __( 'Change Date' ) }\n\t\t\t\t\t\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t\t\t\t\t\t\tonKeyDown={ openOnArrowDown }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t) }\n\t\t\t</BlockControls>\n\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t\t\t<DateFormatPicker\n\t\t\t\t\t\tformat={ format }\n\t\t\t\t\t\tdefaultFormat={ siteFormat }\n\t\t\t\t\t\tonChange={ ( nextFormat ) =>\n\t\t\t\t\t\t\tsetAttributes( { format: nextFormat } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\tpostType?.labels.singular_name\n\t\t\t\t\t\t\t\t? sprintf(\n\t\t\t\t\t\t\t\t\t\t// translators: %s: Name of the post type e.g: \"post\".\n\t\t\t\t\t\t\t\t\t\t__( 'Link to %s' ),\n\t\t\t\t\t\t\t\t\t\tpostType.labels.singular_name.toLowerCase()\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: __( 'Link to post' )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={ () => setAttributes( { isLink: ! isLink } ) }\n\t\t\t\t\t\tchecked={ isLink }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Display last modified date' ) }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\tdisplayType: value ? 'modified' : 'date',\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchecked={ displayType === 'modified' }\n\t\t\t\t\t\thelp={ __(\n\t\t\t\t\t\t\t'Only shows if the post has been modified'\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\n\t\t\t<div { ...blockProps }>{ postDate }</div>\n\t\t</>\n\t);\n}\n\nexport function is12HourFormat( format ) {\n\t// To know if the time format is a 12 hour time, look for any of the 12 hour\n\t// format characters: 'a', 'A', 'g', and 'h'. The character must be\n\t// unescaped, i.e. not preceded by a '\\'. Coincidentally, 'aAgh' is how I\n\t// feel when working with regular expressions.\n\t// https://www.php.net/manual/en/datetime.format.php\n\treturn /(?:^|[^\\\\])[aAgh]/.test( format );\n}\n"],"mappings":"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","ignoreList":[]}