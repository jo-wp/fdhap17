{"version":3,"names":["useCommand","useCommandLoader","__","plus","getPath","store","coreStore","useSelect","useDispatch","useCallback","useMemo","noticesStore","privateApis","routerPrivateApis","unlock","useHistory","useAddNewPageCommand","isSiteEditor","window","location","href","includes","history","isBlockBasedTheme","select","getCurrentTheme","is_block_theme","saveEntityRecord","createErrorNotice","createPageEntity","close","page","status","throwOnError","id","push","postId","postType","canvas","error","errorMessage","message","code","type","commands","addNewPage","document","name","label","icon","callback","isLoading","useAdminNavigationCommands","hook"],"sources":["@wordpress/core-commands/src/admin-navigation-commands.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useCommand, useCommandLoader } from '@wordpress/commands';\nimport { __ } from '@wordpress/i18n';\nimport { plus } from '@wordpress/icons';\nimport { getPath } from '@wordpress/url';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useCallback, useMemo } from '@wordpress/element';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { privateApis as routerPrivateApis } from '@wordpress/router';\n\n/**\n * Internal dependencies\n */\nimport { unlock } from './lock-unlock';\n\nconst { useHistory } = unlock( routerPrivateApis );\n\nfunction useAddNewPageCommand() {\n\tconst isSiteEditor = getPath( window.location.href )?.includes(\n\t\t'site-editor.php'\n\t);\n\tconst history = useHistory();\n\tconst isBlockBasedTheme = useSelect( ( select ) => {\n\t\treturn select( coreStore ).getCurrentTheme()?.is_block_theme;\n\t}, [] );\n\tconst { saveEntityRecord } = useDispatch( coreStore );\n\tconst { createErrorNotice } = useDispatch( noticesStore );\n\n\tconst createPageEntity = useCallback(\n\t\tasync ( { close } ) => {\n\t\t\ttry {\n\t\t\t\tconst page = await saveEntityRecord(\n\t\t\t\t\t'postType',\n\t\t\t\t\t'page',\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus: 'draft',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tthrowOnError: true,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif ( page?.id ) {\n\t\t\t\t\thistory.push( {\n\t\t\t\t\t\tpostId: page.id,\n\t\t\t\t\t\tpostType: 'page',\n\t\t\t\t\t\tcanvas: 'edit',\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} catch ( error ) {\n\t\t\t\tconst errorMessage =\n\t\t\t\t\terror.message && error.code !== 'unknown_error'\n\t\t\t\t\t\t? error.message\n\t\t\t\t\t\t: __( 'An error occurred while creating the item.' );\n\n\t\t\t\tcreateErrorNotice( errorMessage, {\n\t\t\t\t\ttype: 'snackbar',\n\t\t\t\t} );\n\t\t\t} finally {\n\t\t\t\tclose();\n\t\t\t}\n\t\t},\n\t\t[ createErrorNotice, history, saveEntityRecord ]\n\t);\n\n\tconst commands = useMemo( () => {\n\t\tconst addNewPage =\n\t\t\tisSiteEditor && isBlockBasedTheme\n\t\t\t\t? createPageEntity\n\t\t\t\t: () =>\n\t\t\t\t\t\t( document.location.href =\n\t\t\t\t\t\t\t'post-new.php?post_type=page' );\n\t\treturn [\n\t\t\t{\n\t\t\t\tname: 'core/add-new-page',\n\t\t\t\tlabel: __( 'Add new page' ),\n\t\t\t\ticon: plus,\n\t\t\t\tcallback: addNewPage,\n\t\t\t},\n\t\t];\n\t}, [ createPageEntity, isSiteEditor, isBlockBasedTheme ] );\n\n\treturn {\n\t\tisLoading: false,\n\t\tcommands,\n\t};\n}\n\nexport function useAdminNavigationCommands() {\n\tuseCommand( {\n\t\tname: 'core/add-new-post',\n\t\tlabel: __( 'Add new post' ),\n\t\ticon: plus,\n\t\tcallback: () => {\n\t\t\tdocument.location.href = 'post-new.php';\n\t\t},\n\t} );\n\n\tuseCommandLoader( {\n\t\tname: 'core/add-new-page',\n\t\thook: useAddNewPageCommand,\n\t} );\n}\n"],"mappings":"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","ignoreList":[]}